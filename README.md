# Архиватор XArch: Руководство по режимам и флагам

## Основные режимы работы

| Режим       | Флаг | Описание                  |
|-------------|------|---------------------------|
| Compress    | `-c` | Создание нового архива    |
| Extract     | `-x` | Распаковка архива         |
| Append      | `-a` | Добавление файлов в архив |
| Update      | `-u` | Обновление архива         |
| Test        | `-T` | Проверка целостности      |
| Info        | `-h` | Вывод справки             |

---

## Матрица совместимости флагов

### Основные правила
1. **Только один основной режим** может быть активен за раз
2. `-h` (help) **несовместим** с другими режимами
3. `-o` (output) **обязателен** для всех режимов кроме `-h`

### Таблица совместимости
| Флаг | -c | -x | -a | -u | -T | -h | -f | -o | -l | -s |
|------|----|----|----|----|----|----|----|----|----|----|
| -c   | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✔️ | ✔️ | ✔️ | ✔️ |
| -x   | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✔️ | ❌ | ❌ |
| -a   | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✔️ | ✔️ | ✔️ | ✔️ |
| -u   | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✔️ | ✔️ | ✔️ | ✔️ |
| -T   | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✔️ | ❌ | ❌ |
| -h   | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |

---

## Детализация режимов

### 1. Режим Compress (`-c`)
**Требуемые флаги:**
- `-f` / `--files` - входные файлы
- `-o` / `--output` - имя архива

**Опциональные флаги:**
- `-t` / `--type` - формат архива (по умолчанию: zip)
- `-l` / `--level` - уровень сжатия 0-9 (6)
- `-s` / `--split` - разделение на части (например, 100M)
- `-p` / `--password` - шифрование архива
- `-X` / `--exclude` - исключение файлов по шаблону

**Пример:**
```bash
./xarch -c -f file1.txt dir/ -o archive.zip -l 9 -s 500M
```

### 2. Режим Extract ('-x')
**Требуемые флаги:**
- `-o` / `--output` - имя архива

**Опциональные флаги:**
-`p` / `--password` - пароль для расшифровки
-`r` / `--preserve` - сохранять структуру каталогов

**Пример**
```bash
./xarch -x -o archive.zip -p "mysecret"
```

### 3. Режим Append('-a')
**Требуемые флаги:**

-`f` / `--files` - добавляемые файлы
- `-o` / `--output` - существующий архив
**Особенности:**
- Поддерживает те же опции, что и Compress
- Нельзя менять тип архива
**Пример**
```bash
./xarch -x -o archive.zip -p "mysecret"
```

### 4. Режим Update('-u')
**Требуемые флаги:**

-`f` / `--files` - обновляемые файлы
- `-o` / `--output` - архив для обновления
  **Отличия от Append:**
- Заменяет существующие файлы в архиве
- Проверяет контрольные суммы
  **Пример**
```bash
./xarch -x -o archive.zip -p "mysecret"
```
## Запрещённые комбинации ##

---
1. Совмещение основных режимов
`-c -x`, `-a -u` и т.д. - вызовут ошибку

2. Использование -h с другими флагами
`-h -c` - запрещено

3. Отсутствие обязательных параметров
`-c без -f и -o` - ошибка валидации

4. Некорректные значения
`-l 10` (уровень сжатия >9) - ошибка
---
## Особые случаи ##
Самораспаковывающиеся архивы (-S)
- Работает только с -c
- Требует указания типа архива

```bash
./xarch -c -f file.txt -o archive.exe -S
```
**Тестирование архивов (-T)**
- Проверяет целостность без распаковки
- Может работать с повреждёнными архивами

```bash
./xarch -T -o archive.zip
```
## Примеры использования ##

---
### Действительные команды ###
1. Создание зашифрованного архива:

```bash
./xarch -c -f *.txt -o backup.zip -p "secret" -l 9
```
2. Распаковка с сохранением структуры:

```bash
./xarch -x -o backup.zip -r -d /target/path
```

### Недопустимые команды ###
1. Конфликт режимов:

```bash
./xarch -c -x -o archive.zip # Ошибка: нельзя одновременно сжимать и распаковывать
```
2. Пропущены обязательные параметры:

```bash
./xarch -c -o archive.zip # Ошибка: не указаны файлы (-f)
```

### Примечания ###
1. Приоритет флагов:
При конфликте параметров (например, разные уровни сжатия) последний указанный флаг имеет приоритет

2. Логирование:
Используйте --verbose для вывода подробной информации о процессе

3. Специальные символы:
Для путей с пробелами используйте кавычки:
-f "My Documents/file.txt"

4. Поддерживаемые форматы:
ZIP, TAR, 7Z (список может расширяться)

